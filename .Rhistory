getSrcDirectory()
getwd()
setwd("C:\My_Stuff\Work\R\DiscountTrends")
setwd("C:/My_Stuff/Work/R/DiscountTrends")
getwd()
cls
data <- read.csv("Discount_data.csv", head = TRUE, sep = ",")
View(data)
data <- data[,c("created", "total", "original", "discount", "tax", "deliveryCharge", "paymentId", "paymentMode", "state", "syle")]
data <- data[, c(2, 3, 4, 5, 6, 7, 9, 10, 11, 12)]
data <- data[! data$state %in% c("cancelled"),]
data$day <- weekdays(as.Date(data$created))
predata <- read.csv("Discount_data.csv", head = TRUE, sep = ",")
View(predata)
data <- predata[, c(2, 3, 4, 5, 7, 10, 11, 12)]
data <- data[! data$state %in% c("cancelled"),]
data$day <- weekdays(as.Date(data$created))
View(data)
Install.packages("e1071")
install.packages("e1071")
library(e1071)
svmModel <- svm(day ~ ., data = data[1:550])
svmModel <- svm(day ~ ., data = data[c(1:550),])
help("svm")
svmModel <- svm(day ~ ., data = data)
attach(data)
svmModel <- svm(day ~ ., data = data)
svmModel <- svm(data$day ~ ., data = data)
svmModel <- svm(data, as.factor(data$day))
data <- data[! data$paymentMode %in% c("#N/A"),]
svmModel <- svm(data, as.factor(data$day))
svmModel <- svm(~., data = data)
svmModel <- svm(~day, data = data)
View(data)
nrow(data)
View(data)
data <- data[1:748,]
svmModel <- svm(~day, data = data)
svmModel <- svm(~., data=data)
summary(svmMo)
summary(svmModel)
svmModel <- svm(as.factor(data$day[1:600,])~., data=data$day[1:600,])
svmModel <- svm(as.factor(data$day[1:600])~., data=data$day[1:600])
svmModel <- svm(as.factor(data$day[1:600])~., data=data$day[1:600,])
index <- 1:nrow(data)
testindex <- sample(index, trunc(length(index)/3))
testset <- data[testindex,]
trainset <- data[-testindex,]
View(testset)
View(trainset)
svmModel <- svm(day ~ ., data = trainset)
svmModel <- svm(day ~ ., data = trainset, cost = 100, gamma = 1)
svmModel <- svm(as.factor(day) ~ ., data = trainset, cost = 100, gamma = 1)
svmModel <- svm(as.factor(day) ~ ., data = trainset)
svm.model <- svm(day ~ ., data = trainset)
svm.model <- svm(as.factor(day) ~ ., data = trainset)
View(trainset)
svm.pred <- predict(svm.model, test[, -9])
svm.pred <- predict(svm.model, testset[, -9])
table(pred = svm.pred, true = testset[,9])
summary(svm())
summary(svm.model)
install.packages("caret")
library(caret)
accuracy <- numeric()
confMat <- confusionMatrix(svm.pred, testset$day)
confMat
temp <- confMat$overall[['Accuracy']]
accuracy <- confMat$overall[['Accuracy']]
colnames(data)
